<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户信息</title>
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <link href="packages/mui@3.4.0/dist/css/mui.min.css" rel="stylesheet"/>
    <!--App自定义的css-->
    <link href="css/app.css?ver=16.12.376" rel="stylesheet"/>
    <style type="text/css">
        input[type=text], input[type=password] {
            padding: 5px;
            border: 0;
            margin-bottom: 0;
        }

        .mui-table-view:before, .mui-table-view-cell:after, .mui-table-view:after {
            height: 0;
        }

        .mui-table-view-cell {
            padding: 5px 8px;
        }

        .input-upload-image, .upload-btn {
            width: 160px;
            height: 110px;
            float: left;
        }

        .input-upload-image {
            z-index: 1;
            border: none;
            -webkit-opacity: 0;
            opacity: 0;
        }

        .upload-btn {
            z-index: 2;
            margin-top: -110px;
        }

        .input-upload-image2, .upload-btn2 {
            width: 160px;
            height: 110px;
            float: left;
        }

        .input-upload-image2 {
            z-index: 1;
            border: none;
            -webkit-opacity: 0;
            opacity: 0;
        }

        .upload-btn2 {
            z-index: 2;
            margin-top: -110px;
        }

        .events-pointer-none {
            pointer-events: none;
            cursor: pointer;
        }

        .selecttype {
            background-color: #ffffff;
            border-radius: 6px;
            padding: 10px 20px;
            border: 2px dotted #cccccc;
            position: relative
        }

        .selecttype.active {
            border: 1px solid #fd8b14;
        }

        .selecttype img {
            opacity: 0.4;
        }

        .active img {
            opacity: 1;
        }

        .selectv {
            width: 30px;
            height: 30px;
            position: absolute;
            top: -8px;
            right: -8px;
        }
    </style>
</head>
<body style="background-color:#f0f0f0">
<div class="mui-content" style="background:none">
    <div class="step0" style="background-color:#f0f0f0">
        <div style="height:60px;line-height:60px;text-align: center;font-size: 16px;color: #646464">
            请选择证件类型
        </div>
        <div style="background-color:#f0f0f0">
            <div style="width:49%;float:left;padding-left:15px">
                <div class="selecttype" onclick="chooseType(0)">
                    <img src="images/sfzv.png" style="width:100%">
                    <div style="text-align:center;font-size: 14px;color:#646464">身份证</div>
                    <div style="text-align:center;font-size:10px;color:#999999">&nbsp;</div>
                    <img src="images/selectv.png" class="selectv" style="display:none">
                </div>
            </div>
            <div style="width:49%;float:right; padding-right:15px">
                <div class="selecttype" onclick="chooseType(1)">
                    <img src="images/hzv.png" style="width:100%">
                    <div style="text-align:center;font-size:14px;color:#646464">护照</div>
                    <div style="text-align:center;font-size:10px;color:#999999">仅支持国外用户</div>
                    <img src="images/selectv.png" class="selectv" style="display:none">
                </div>
            </div>
        </div>
    </div>
    <div class="step0" style="clear:both"></div>
    <div class="step0" style="padding-left:20px;padding-right:20px;background-color:#ffffff;margin-top:20px">
        <div style="border-bottom:1px solid #d8d8d8;height:60px;line-height:60px">
            <input id="txtRealName" type="text" placeholder="请输入真实姓名" maxlength="10">
        </div>
        <div style="height:60px;line-height:60px">
            <input id="txtCredentialNo" type="text" placeholder="请输入证件号码" maxlength="18">
        </div>
    </div>
    <div class="step0" style="text-align:center;margin-top:30px;background-color:#f0f0f0">
        <button class="btnActive"
                style="background:#ff8c14;border-radius:44px;height:44px;color:#ffffff;font-size:18px;width:90%"
                onclick="step()">下一步
        </button>
    </div>
    <div class="step1" style="padding-left:20px;padding-right:20px;display:none">
        <div id="lbTitle1"
             style="height:30px;line-height:30px;font-size:16px;color:#646464;text-align: center;margin-top:30px">
            请上传您的有效二代身份证
        </div>
        <div id="divIdentity1"
             style="margin-top: 20px;height:180px;background-color: #ffffff;padding-top:20px;cursor:pointer;border:1px dashed #fd8b14;border-radius:6px">
            <div style="text-align:center">
                <div style="height:110px;width:160px;display:inline-block">
                    <input type="file" accept="image/*" id="img1" name="img2" class="input-upload-image"/>
                    <img id="imgDemo1" src="images/sfz1.png" class="upload-btn events-pointer-none"
                         style="height:110px;width:160px"/>
                </div>
            </div>
            <div id="lbTitle2" style="text-align:center;margin-top:5px">
                上传身份证正面
            </div>
        </div>
        <div id="divIdentity1Img"
             style="margin-top: 20px;height:180px;text-align:center;background-color: #ffffff;display:none">
            <img id="imgIdentity1" src="images/demo1.jpg" style="width:100%;height:100%;border-radius:6px">
        </div>
        <div id="divIdentity2"
             style="margin-top: 20px;height:180px;text-align:center;background-color: #ffffff;padding-top:20px;cursor:pointer;border:1px dashed #fd8b14;border-radius:6px">
            <div style="text-align:center">
                <div style="height:110px;width:160px;display:inline-block">
                    <input type="file" accept="image/*" id="img2" name="img2" class="input-upload-image2"/>
                    <img id="imgDemo2" src="images/sfz2.png" class="upload-btn2 events-pointer-none"
                         style="height:110px;width:160px"/>
                </div>
            </div>
            <div id="lbTitle3" style="text-align:center;margin-top:5px">
                上传身份证背面
            </div>
        </div>
        <div id="divIdentity2Img"
             style="margin-top: 20px;height:180px;text-align:center;background-color: #ffffff;display:none">
            <img id="imgIdentity2" src="images/demo2.jpg" style="width: 100%;height:100%;border-radius:6px">
        </div>
        <div style="text-align:center;margin-top:30px">
            <button id="btnlease" class="btnActive"
                    style="background:#ff8c14;border-radius:44px;height:44px;color:#ffffff;font-size:18px;width:100%"
                    onclick="verify()">提交
            </button>
        </div>
        <div style="height:30px"></div>
    </div>
</div>
<div class="msg-post">
    <table style='width:100%;height:100%'>
        <tr>
            <td style='vertical-align:middle'>
                <div>
                    <img src="images/loading.gif" style="width:auto;height:40px">
                </div>
                <div style="font-size:16px">
                    提交中，请等待...
                </div>
            </td>
        </tr>
    </table>
</div>
</body>
</html>
<script src="packages/jquery@3.1.1/dist/jquery.min.js"></script>
<script src="packages/mui@3.4.0/dist/js/mui.min.js"></script>
<script src="script/constants.js?ver=16.12.376"></script>
<script src="script/service.js?ver=16.12.376"></script>
<script src="script/verify.js?ver=16.12.376"></script>
<script type="text/javascript">
    // 照片的最大边压缩到该值
    var maxSize = 200 * 1024;
    var compress = function (res, fileSize, imgIndex) {
        var img = new Image();
        img.onload = function () {
            var ratio = (fileSize >= maxSize ? 0.2 : 1);
            var width = img.width;
            var height = img.height;
            var cvs = document.createElement('canvas');
            var ctx = cvs.getContext('2d');
            cvs.width = width;
            cvs.height = height;
            ctx.fillRect(0, 0, cvs.width, cvs.height);
            ctx.drawImage(img, 0, 0, width, height);
            var data = cvs.toDataURL('image/jpeg', ratio);
            V2UploadImages(data, imgIndex)

        };
        img.src = res;
    };
    mui.init({
        swipeBack: true //启用右滑关闭功能
    });
    document.getElementById('img1').addEventListener('change', function () {
        var reader = new FileReader();
        reader.onload = function () {
            compress(this.result, this.result.length, 0);
        };
        reader.readAsDataURL(this.files[0]);
    }, false);

    document.getElementById('img2').addEventListener('change', function () {
        var reader = new FileReader();
        reader.onload = function () {
            compress(this.result, this.result.length, 1);
        };
        reader.readAsDataURL(this.files[0]);
    }, false);
</script>